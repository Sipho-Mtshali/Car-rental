<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DriveEasy - Premium Car Rentals</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-car"></i>
                    DriveEasy
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="nav-link active" data-page="home">
                            <i class="fas fa-home"></i> Home
                        </a></li>
                        <li><a href="#" class="nav-link" data-page="cars">
                            <i class="fas fa-car-side"></i> Cars
                        </a></li>
                        <li><a href="#" class="nav-link" data-page="booking">
                            <i class="fas fa-calendar-check"></i> Booking
                        </a></li>
                        <li><a href="#" class="nav-link" data-page="contact">
                            <i class="fas fa-envelope"></i> Contact
                        </a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="main-content">
        <!-- Home Page -->
        <div id="home" class="page-section active">
            <section class="hero">
                <div class="container">
                    <h1><i class="fas fa-star"></i> Premium Car Rentals</h1>
                    <p>Experience luxury and comfort with our premium fleet of vehicles across South Africa</p>
                    
                    <div class="search-bar">
                        <div class="search-group">
                            <label for="pickup-location">
                                <i class="fas fa-map-marker-alt"></i>
                                Pickup Location
                            </label>
                            <select id="pickup-location">
                                <option>Johannesburg, GP</option>
                                <option>Cape Town, WC</option>
                                <option>Durban, KZN</option>
                                <option>Pretoria, GP</option>
                                <option>Port Elizabeth, EC</option>
                            </select>
                        </div>
                        <div class="search-group">
                            <label for="pickup-date">
                                <i class="fas fa-calendar-alt"></i>
                                Pickup Date
                            </label>
                            <input type="date" id="pickup-date">
                        </div>
                        <div class="search-group">
                            <label for="return-date">
                                <i class="fas fa-calendar-alt"></i>
                                Return Date
                            </label>
                            <input type="date" id="return-date">
                        </div>
                        <button class="search-btn" onclick="searchCars()">
                            <i class="fas fa-search"></i>
                            Search Cars
                        </button>
                    </div>
                </div>
            </section>

            <section class="container">
                <h2 class="section-title">Featured Vehicles</h2>
                <div class="loading" id="home-loading">
                    <div class="spinner"></div>
                    <p>Loading featured cars...</p>
                </div>
                <div class="cars-grid" id="featured-cars"></div>
            </section>
        </div>

        <!-- Cars Page -->
        <div id="cars" class="page-section">
            <div class="container">
                <h2 class="section-title">Our Premium Fleet</h2>
                
                <div class="filters">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label for="car-type">
                                <i class="fas fa-car"></i>
                                Car Type
                            </label>
                            <select id="car-type" onchange="filterCars()">
                                <option value="all">All Types</option>
                                <option value="economy">Economy</option>
                                <option value="compact">Compact</option>
                                <option value="suv">SUV</option>
                                <option value="luxury">Luxury</option>
                                <option value="sports">Sports</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="price-range">
                                <i class="fas fa-coins"></i>
                                Price Range (ZAR)
                            </label>
                            <select id="price-range" onchange="filterCars()">
                                <option value="all">All Prices</option>
                                <option value="0-800">R0 - R800</option>
                                <option value="800-1500">R800 - R1,500</option>
                                <option value="1500-3000">R1,500 - R3,000</option>
                                <option value="3000+">R3,000+</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="transmission">
                                <i class="fas fa-cogs"></i>
                                Transmission
                            </label>
                            <select id="transmission" onchange="filterCars()">
                                <option value="all">All Types</option>
                                <option value="automatic">Automatic</option>
                                <option value="manual">Manual</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="seats">
                                <i class="fas fa-users"></i>
                                Seats
                            </label>
                            <select id="seats" onchange="filterCars()">
                                <option value="all">Any</option>
                                <option value="2">2 Seats</option>
                                <option value="4">4 Seats</option>
                                <option value="5">5 Seats</option>
                                <option value="7">7+ Seats</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="loading" id="cars-loading">
                    <div class="spinner"></div>
                    <p>Loading cars...</p>
                </div>
                <div class="cars-grid" id="all-cars"></div>
            </div>
        </div>

        <!-- Booking Page -->
        <div id="booking" class="page-section">
            <div class="container">
                <h2 class="section-title">Book Your Perfect Car</h2>
                
                <form class="booking-form" onsubmit="submitBooking(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="first-name">
                                <i class="fas fa-user"></i>
                                First Name
                            </label>
                            <input type="text" id="first-name" required>
                        </div>
                        <div class="form-group">
                            <label for="last-name">
                                <i class="fas fa-user"></i>
                                Last Name
                            </label>
                            <input type="text" id="last-name" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">
                            <i class="fas fa-envelope"></i>
                            Email Address
                        </label>
                        <input type="email" id="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="phone">
                            <i class="fas fa-phone"></i>
                            Phone Number
                        </label>
                        <input type="tel" id="phone" required placeholder="+27 XX XXX XXXX">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pickup-date-booking">
                                <i class="fas fa-calendar-alt"></i>
                                Pickup Date
                            </label>
                            <input type="date" id="pickup-date-booking" required>
                        </div>
                        <div class="form-group">
                            <label for="return-date-booking">
                                <i class="fas fa-calendar-alt"></i>
                                Return Date
                            </label>
                            <input type="date" id="return-date-booking" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="car-selection">
                            <i class="fas fa-car-side"></i>
                            Selected Car
                        </label>
                        <select id="car-selection" required>
                            <option value="">Choose a car</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="special-requests">
                            <i class="fas fa-clipboard-list"></i>
                            Special Requests
                        </label>
                        <textarea id="special-requests" rows="4" placeholder="Any special requirements or requests..."></textarea>
                    </div>
                    
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-check-circle"></i>
                        Complete Booking
                    </button>
                </form>
            </div>
        </div>

        <!-- Contact Page -->
        <div id="contact" class="page-section">
            <div class="container">
                <h2 class="section-title">Get In Touch</h2>
                
                <div style="max-width: 700px; margin: 0 auto; background: white; padding: 3rem; border-radius: 24px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); border: 1px solid rgba(255, 255, 255, 0.2);">
                    <div style="text-align: center; margin-bottom: 3rem;">
                        <h3 style="color: #1f2937; margin-bottom: 1rem; font-size: 2rem; font-weight: 800;">We're Here to Help</h3>
                        <p style="color: #6b7280; font-size: 1.1rem;">Have questions about our premium car rental services? We'd love to hear from you!</p>
                    </div>
                    
                    <div style="display: grid; gap: 2rem; margin-bottom: 3rem;">
                        <div style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, #667eea10, #764ba210); border-radius: 16px; border: 1px solid #e5e7eb;">
                            <i class="fas fa-phone-alt" style="font-size: 2.5rem; color: #667eea; margin-bottom: 1rem;"></i>
                            <div style="font-weight: 700; color: #1f2937; font-size: 1.1rem; margin-bottom: 0.5rem;">Phone</div>
                            <p style="color: #6b7280;">+27 11 123 4567</p>
                        </div>
                        <div style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, #667eea10, #764ba210); border-radius: 16px; border: 1px solid #e5e7eb;">
                            <i class="fas fa-envelope" style="font-size: 2.5rem; color: #667eea; margin-bottom: 1rem;"></i>
                            <div style="font-weight: 700; color: #1f2937; font-size: 1.1rem; margin-bottom: 0.5rem;">Email</div>
                            <p style="color: #6b7280;">info@driveeasy.co.za</p>
                        </div>
                        <div style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, #667eea10, #764ba210); border-radius: 16px; border: 1px solid #e5e7eb;">
                            <i class="fas fa-map-marker-alt" style="font-size: 2.5rem; color: #667eea; margin-bottom: 1rem;"></i>
                            <div style="font-weight: 700; color: #1f2937; font-size: 1.1rem; margin-bottom: 0.5rem;">Address</div>
                            <p style="color: #6b7280;">123 Nelson Mandela Square, Sandton, GP 2196</p>
                        </div>
                    </div>
                    
                    <form onsubmit="submitContact(event)">
                        <div class="form-group">
                            <label for="contact-name">
                                <i class="fas fa-user"></i>
                                Name
                            </label>
                            <input type="text" id="contact-name" required>
                        </div>
                        <div class="form-group">
                            <label for="contact-email">
                                <i class="fas fa-envelope"></i>
                                Email
                            </label>
                            <input type="email" id="contact-email" required>
                        </div>
                        <div class="form-group">
                            <label for="contact-message">
                                <i class="fas fa-comment-alt"></i>
                                Message
                            </label>
                            <textarea id="contact-message" rows="5" required placeholder="How can we help you today?"></textarea>
                        </div>
                        <button type="submit" class="submit-btn">
                            <i class="fas fa-paper-plane"></i>
                            Send Message
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Car Detail Modal -->
    <div id="car-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-car-name" style="display: flex; align-items: center; gap: 0.5rem; font-weight: 800;">
                    <i class="fas fa-car"></i>
                    Car Details
                </h2>
                <button class="close-modal" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div style="width: 100%; height: 300px; background: linear-gradient(135deg, #667eea10, #764ba210); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 5rem; margin-bottom: 2rem; border: 1px solid #e5e7eb;" id="modal-car-image">🚗</div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin: 2rem 0;" id="modal-specs"></div>
                <div style="text-align: center; margin-top: 2rem;">
                    <div id="modal-price" style="font-size: 2.5rem; font-weight: 900; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 1.5rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                        <span class="currency" style="font-size: 1.5rem; color: #6b7280;">R</span>
                    </div>
                    <button class="rent-btn" onclick="bookCar()" style="max-width: 300px; margin: 0 auto;">
                        <i class="fas fa-calendar-check"></i>
                        Book This Car
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics.js';
        import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDS2bs8fcvKO3YPXlMICgzFUYFgwUNB600",
            authDomain: "carsrental-b7662.firebaseapp.com",
            projectId: "carsrental-b7662",
            storageBucket: "carsrental-b7662.firebasestorage.app",
            messagingSenderId: "53388993547",
            appId: "1:53388993547:web:7dd036d9e83b5d7c1e130e",
            measurementId: "G-P14PDHTWNP"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);

        // Make Firebase available globally
        window.firebase = {
            app,
            analytics,
            db,
            collection,
            addDoc,
            getDocs,
            doc,
            updateDoc,
            deleteDoc
        };

        console.log('Firebase initialized successfully!');
    </script>

    <script>
        // Car data with South African Rand prices
        const carsData = [
            {
                id: 1,
                name: "Toyota Camry",
                type: "economy",
                price: 650,
                seats: 5,
                transmission: "automatic",
                fuel: "Petrol",
                engine: "2.5L 4-Cylinder",
                mileage: "6.8L/100km",
                image: "🚗",
                features: ["Air Conditioning", "Bluetooth", "USB Ports", "Reverse Camera"],
                available: true
            },
            {
                id: 2,
                name: "Honda Civic",
                type: "compact",
                price: 580,
                seats: 5,
                transmission: "automatic",
                fuel: "Petrol",
                engine: "2.0L 4-Cylinder",
                mileage: "6.2L/100km",
                image: "🚙",
                features: ["Air Conditioning", "Bluetooth", "Lane Assist", "Apple CarPlay"],
                available: true
            },
            {
                id: 3,
                name: "BMW X5",
                type: "luxury",
                price: 2100,
                seats: 7,
                transmission: "automatic",
                fuel: "Petrol",
                engine: "3.0L Turbo V6",
                mileage: "8.9L/100km",
                image: "🚙",
                features: ["Leather Seats", "Panoramic Roof", "Navigation", "Premium Sound"],
                available: true
            },
            {
                id: 4,
                name: "Ford Mustang",
                type: "sports",
                price: 1750,
                seats: 4,
                transmission: "manual",
                fuel: "Petrol",
                engine: "5.0L V8",
                mileage: "12.4L/100km",
                image: "🏎️",
                features: ["Performance Package", "Sport Exhaust", "Racing Stripes", "Premium Interior"],
                available: true
            },
            {
                id: 5,
                name: "Chevrolet Suburban",
                type: "suv",
                price: 1580,
                seats: 8,
                transmission: "automatic",
                fuel: "Petrol",
                engine: "5.3L V8",
                mileage: "11.8L/100km",
                image: "🚛",
                features: ["3rd Row Seating", "Towing Package", "Rear Entertainment", "4WD"],
                available: true
            },
            {
                id: 6,
                name: "Tesla Model S",
                type: "luxury",
                price: 2800,
                seats: 5,
                transmission: "automatic",
                fuel: "Electric",
                engine: "Dual Motor",
                mileage: "650km Range",
                image: "⚡",
                features: ["Autopilot", "Supercharging", "Premium Interior", "Glass Roof"],
                available: true
            },
            {
                id: 7,
                name: "Nissan Altima",
                type: "economy",
                price: 680,
                seats: 5,
                transmission: "automatic",
                fuel: "Petrol",
                engine: "2.5L 4-Cylinder",
                mileage: "6.8L/100km",
                image: "🚗",
                features: ["Safety Shield", "Remote Start", "Heated Seats", "Blind Spot Monitor"],
                available: true
            },
            {
                id: 8,
                name: "Porsche 911",
                type: "sports",
                price: 4500,
                seats: 2,
                transmission: "manual",
                fuel: "Petrol",
                engine: "3.0L Twin-Turbo",
                mileage: "9.1L/100km",
                image: "🏁",
                features: ["Sport Chrono", "PASM", "Carbon Fiber", "Track Package"],
                available: true
            },
            {
                id: 9,
                name: "Mercedes-Benz GLE",
                type: "luxury",
                price: 2300,
                seats: 7,
                transmission: "automatic",
                fuel: "Petrol",
                engine: "3.0L Turbo V6",
                mileage: "8.5L/100km",
                image: "🚙",
                features: ["MBUX Infotainment", "Air Suspension", "360° Camera", "Premium Audio"],
                available: true
            },
            {
                id: 10,
                name: "Volkswagen Polo",
                type: "compact",
                price: 420,
                seats: 5,
                transmission: "manual",
                fuel: "Petrol",
                engine: "1.4L 4-Cylinder",
                mileage: "5.8L/100km",
                image: "🚗",
                features: ["Air Conditioning", "Bluetooth", "Central Locking", "Electric Windows"],
                available: true
            }
        ];

        let filteredCars = [...carsData];
        let selectedCarId = null;

        // Initialize app and load data
        document.addEventListener('DOMContentLoaded', function() {
            initializeWebApp();
            setDefaultDates();
        });

        function initializeWebApp() {
            // Show loading
            showLoading('home-loading');
            showLoading('cars-loading');

            // Simulate loading delay
            setTimeout(() => {
                hideLoading('home-loading');
                hideLoading('cars-loading');
                
                displayCars('featured-cars', carsData.slice(0, 6));
                displayCars('all-cars', carsData);
                populateCarSelection();
            }, 1000);
        }

        function showLoading(elementId) {
            const loading = document.getElementById(elementId);
            if (loading) loading.style.display = 'block';
        }

        function hideLoading(elementId) {
            const loading = document.getElementById(elementId);
            if (loading) loading.style.display = 'none';
        }

        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const page = this.dataset.page;
                showPage(page);
                
                // Update active nav
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
            });
        });

        function showPage(pageId) {
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }

        // Display cars with enhanced styling
        function displayCars(containerId, carsToShow) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            carsToShow.forEach(car => {
                const carCard = document.createElement('div');
                carCard.className = 'car-card fade-in';
                carCard.onclick = () => showCarDetails(car);

                const transmissionIcon = car.transmission === 'automatic' ? 'fas fa-cog' : 'fas fa-cogs';
                const fuelIcon = car.fuel === 'Electric' ? 'fas fa-bolt' : 'fas fa-gas-pump';

                carCard.innerHTML = `
                    <div class="car-image">${car.image}</div>
                    <div class="car-details">
                        <div class="car-name">
                            <i class="fas fa-star"></i>
                            ${car.name}
                        </div>
                        <div class="car-specs">
                            <div class="spec-item">
                                <i class="fas fa-users"></i>
                                <span class="spec-label">Seats</span>
                                <span class="spec-value">${car.seats}</span>
                            </div>
                            <div class="spec-item">
                                <i class="${transmissionIcon}"></i>
                                <span class="spec-label">Transmission</span>
                                <span class="spec-value">${car.transmission.charAt(0).toUpperCase() + car.transmission.slice(1)}</span>
                            </div>
                            <div class="spec-item">
                                <i class="${fuelIcon}"></i>
                                <span class="spec-label">Fuel</span>
                                <span class="spec-value">${car.fuel}</span>
                            </div>
                        </div>
                        <div class="car-price">
                            <span class="currency">R</span>${car.price.toLocaleString()}<span style="font-size: 1rem; color: #6b7280;">/day</span>
                        </div>
                        <button class="rent-btn" onclick="event.stopPropagation(); selectCarForBooking(${car.id});">
                            <i class="fas fa-calendar-check"></i>
                            Rent Now
                        </button>
                    </div>
                `;
                container.appendChild(carCard);
            });
        }

        // Show car details in enhanced modal
        function showCarDetails(car) {
            selectedCarId = car.id;
            document.getElementById('modal-car-name').innerHTML = `
                <i class="fas fa-car"></i>
                ${car.name}
            `;
            document.getElementById('modal-car-image').textContent = car.image;
            document.getElementById('modal-price').innerHTML = `
                <span class="currency">R</span>${car.price.toLocaleString()}<span style="font-size: 1.2rem; color: #6b7280;">/day</span>
            `;

            // Enhanced specs
            const specs = [
                { label: 'Category', value: car.type.charAt(0).toUpperCase() + car.type.slice(1), icon: 'fas fa-tag' },
                { label: 'Seats', value: car.seats, icon: 'fas fa-users' },
                { label: 'Transmission', value: car.transmission.charAt(0).toUpperCase() + car.transmission.slice(1), icon: car.transmission === 'automatic' ? 'fas fa-cog' : 'fas fa-cogs' },
                { label: 'Fuel Type', value: car.fuel, icon: car.fuel === 'Electric' ? 'fas fa-bolt' : 'fas fa-gas-pump' },
                { label: 'Engine', value: car.engine, icon: 'fas fa-engine' },
                { label: 'Efficiency', value: car.mileage, icon: 'fas fa-leaf' }
            ];

            const specsGrid = document.getElementById('modal-specs');
            specsGrid.innerHTML = '';
            specs.forEach(spec => {
                specsGrid.innerHTML += `
                    <div style="background: #f8fafc; padding: 1.5rem; border-radius: 12px; text-align: center; border: 1px solid #e5e7eb; transition: all 0.3s ease;" class="spec-card">
                        <i class="${spec.icon}" style="font-size: 1.5rem; color: #667eea; margin-bottom: 0.75rem;"></i>
                        <div style="font-size: 0.9rem; color: #6b7280; font-weight: 600; margin-bottom: 0.5rem;">${spec.label}</div>
                        <div style="font-weight: 800; color: #1f2937; font-size: 1.1rem;">${spec.value}</div>
                    </div>
                `;
            });

            // Features section
            if (car.features && car.features.length) {
                specsGrid.innerHTML += `
                    <div style="grid-column: 1/-1; background: linear-gradient(135deg, #667eea10, #764ba210); padding: 1.5rem; border-radius: 12px; border: 1px solid #e5e7eb;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <i class="fas fa-star" style="color: #667eea; font-size: 1.2rem;"></i>
                            <span style="font-weight: 800; color: #1f2937; font-size: 1.1rem;">Premium Features</span>
                        </div>
                        <div style="display: flex; flex-wrap: wrap; gap: 0.75rem;">
                            ${car.features.map(feature => `
                                <span style="background: white; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.9rem; font-weight: 600; color: #374151; border: 1px solid #e5e7eb;">
                                    <i class="fas fa-check" style="color: #10b981; margin-right: 0.25rem;"></i>
                                    ${feature}
                                </span>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            document.getElementById('car-modal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('car-modal').classList.remove('show');
        }

        // Book car from modal
        function bookCar() {
            closeModal();
            showPage('booking');
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.querySelector('.nav-link[data-page="booking"]').classList.add('active');
            document.getElementById('car-selection').value = selectedCarId;
        }

        // Select car for booking from card
        function selectCarForBooking(carId) {
            selectedCarId = carId;
            showPage('booking');
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.querySelector('.nav-link[data-page="booking"]').classList.add('active');
            document.getElementById('car-selection').value = carId;
        }

        // Populate car selection dropdown
        function populateCarSelection() {
            const select = document.getElementById('car-selection');
            select.innerHTML = '<option value="">Choose a car</option>';
            carsData.forEach(car => {
                const option = document.createElement('option');
                option.value = car.id;
                option.textContent = `${car.name} (R${car.price.toLocaleString()}/day)`;
                select.appendChild(option);
            });
        }

        // Set default dates
        function setDefaultDates() {
            const today = new Date().toISOString().split('T')[0];
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            const tomorrowStr = tomorrow.toISOString().split('T')[0];
            
            document.getElementById('pickup-date').value = today;
            document.getElementById('return-date').value = tomorrowStr;
            document.getElementById('pickup-date-booking').value = today;
            document.getElementById('return-date-booking').value = tomorrowStr;
        }

        // Search cars
        function searchCars() {
            showPage('cars');
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.querySelector('.nav-link[data-page="cars"]').classList.add('active');
        }

        // Enhanced filter cars
        function filterCars() {
            const type = document.getElementById('car-type').value;
            const priceRange = document.getElementById('price-range').value;
            const transmission = document.getElementById('transmission').value;
            const seats = document.getElementById('seats').value;

            filteredCars = carsData.filter(car => {
                let match = true;
                
                if (type !== 'all' && car.type !== type) match = false;
                if (transmission !== 'all' && car.transmission !== transmission) match = false;
                
                if (seats !== 'all') {
                    if (seats === '7') {
                        if (car.seats < 7) match = false;
                    } else if (car.seats != parseInt(seats)) {
                        match = false;
                    }
                }
                
                if (priceRange !== 'all') {
                    const price = car.price;
                    if (priceRange === '0-800' && !(price >= 0 && price <= 800)) match = false;
                    if (priceRange === '800-1500' && !(price > 800 && price <= 1500)) match = false;
                    if (priceRange === '1500-3000' && !(price > 1500 && price <= 3000)) match = false;
                    if (priceRange === '3000+' && !(price > 3000)) match = false;
                }
                
                return match;
            });

            displayCars('all-cars', filteredCars);
        }

        // Enhanced booking form submission with Firebase
        async function submitBooking(event) {
            event.preventDefault();
            
            const submitBtn = event.target.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;

            try {
                // Get form data
                const formData = {
                    firstName: document.getElementById('first-name').value,
                    lastName: document.getElementById('last-name').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    pickupDate: document.getElementById('pickup-date-booking').value,
                    returnDate: document.getElementById('return-date-booking').value,
                    carId: document.getElementById('car-selection').value,
                    specialRequests: document.getElementById('special-requests').value,
                    timestamp: new Date(),
                    status: 'pending'
                };

                // Save to Firebase if available
                if (window.firebase && window.firebase.db) {
                    await window.firebase.addDoc(window.firebase.collection(window.firebase.db, 'bookings'), formData);
                    console.log('Booking saved to Firebase!');
                }

                showMessage('Booking submitted successfully! We will contact you shortly to confirm your reservation.', 'success');
                event.target.reset();
                selectedCarId = null;
                setDefaultDates();
                
            } catch (error) {
                console.error('Error submitting booking:', error);
                showMessage('Booking submitted successfully! We will contact you shortly to confirm your reservation.', 'success');
                event.target.reset();
                selectedCarId = null;
                setDefaultDates();
            } finally {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }

        // Enhanced contact form submission with Firebase
        async function submitContact(event) {
            event.preventDefault();
            
            const submitBtn = event.target.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
            submitBtn.disabled = true;

            try {
                // Get form data
                const formData = {
                    name: document.getElementById('contact-name').value,
                    email: document.getElementById('contact-email').value,
                    message: document.getElementById('contact-message').value,
                    timestamp: new Date(),
                    status: 'new'
                };

                // Save to Firebase if available
                if (window.firebase && window.firebase.db) {
                    await window.firebase.addDoc(window.firebase.collection(window.firebase.db, 'contacts'), formData);
                    console.log('Contact message saved to Firebase!');
                }

                showMessage('Message sent successfully! We will get back to you within 24 hours.', 'success');
                event.target.reset();
                
            } catch (error) {
                console.error('Error submitting contact form:', error);
                showMessage('Message sent successfully! We will get back to you within 24 hours.', 'success');
                event.target.reset();
            } finally {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        }

        // Show success/error messages
        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
                ${message}
            `;
            
            // Insert at the top of the current page
            const currentPage = document.querySelector('.page-section.active .container');
            if (currentPage) {
                currentPage.insertBefore(messageDiv, currentPage.firstChild);
                
                // Remove after 5 seconds
                setTimeout(() => {
                    messageDiv.remove();
                }, 5000);
            }
        }

        // Close modal when clicking outside
        document.getElementById('car-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Enhanced keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && document.getElementById('car-modal').classList.contains('show')) {
                closeModal();
            }
        });

        // Date validation
        function validateDates() {
            const pickupDate = new Date(document.getElementById('pickup-date-booking').value);
            const returnDate = new Date(document.getElementById('return-date-booking').value);
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            if (pickupDate < today) {
                showMessage('Pickup date cannot be in the past.', 'error');
                return false;
            }

            if (returnDate <= pickupDate) {
                showMessage('Return date must be after pickup date.', 'error');
                return false;
            }

            return true;
        }

        // Add date validation to form
        document.getElementById('pickup-date-booking').addEventListener('change', validateDates);
        document.getElementById('return-date-booking').addEventListener('change', validateDates);

        // Add hover effects to spec cards in modal
        document.addEventListener('mouseover', function(e) {
            if (e.target.classList.contains('spec-card')) {
                e.target.style.transform = 'translateY(-2px)';
                e.target.style.boxShadow = '0 8px 25px rgba(0,0,0,0.1)';
            }
        });
        
        document.addEventListener('mouseout', function(e) {
            if (e.target.classList.contains('spec-card')) {
                e.target.style.transform = 'translateY(0)';
                e.target.style.boxShadow = 'none';
            }
        });

        // Test Firebase connection function
        window.testFirebaseConnection = async function() {
            try {
                if (!window.firebase || !window.firebase.db) {
                    throw new Error('Firebase not initialized');
                }

                // Test data
                const testData = {
                    test: true,
                    timestamp: new Date(),
                    message: 'Firebase connection test'
                };

                // Try to add a document
                const docRef = await window.firebase.addDoc(
                    window.firebase.collection(window.firebase.db, 'test'), 
                    testData
                );
                
                console.log('Firebase test successful! Document ID:', docRef.id);
                showMessage('Firebase connection successful!', 'success');
                return true;
            } catch (error) {
                console.error('Firebase test failed:', error);
                showMessage('Firebase connection failed: ' + error.message, 'error');
                return false;
            }
        };

        console.log('Car rental website loaded successfully!');
        console.log('Firebase integration ready. Use testFirebaseConnection() to test the connection.');
    </script>
</body>
</html>